"use strict";(self.webpackChunkfrontend_time=self.webpackChunkfrontend_time||[]).push([[364],{8364:(z,Z,s)=>{s.r(Z),s.d(Z,{UsersModule:()=>k});var C=s(8583),u=s(4655),b=s(3962),h=s(1494),l=s(2789),c=s(2238),t=s(7716),p=s(8295),v=s(9983),d=s(3679),T=s(1095);let w=(()=>{class o{constructor(e,a){this.dialogRef=e,this.data=a}ngOnInit(){}onNoClick(){this.dialogRef.close()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(c.so),t.Y36(c.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-create-user"]],decls:38,vars:4,consts:[[1,"container","mt-2","text-center"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"row","justify-content-center"],["appearance","fill",1,"inputs"],["type","text","matInput","","placeholder","Ingrese el nombre completo del auditor",3,"ngModel","ngModelChange"],["type","email","matInput","","placeholder","Ingrese el correo corporativo",3,"ngModel","ngModelChange"],["matNativeControl","","required","",3,"ngModel","ngModelChange"],["value","CO"],["value","HN"],["value","CR"],["value","SV"],["value","PA"],["value","MA"],[2,"color","red"],["mat-dialog-actions","",1,"justify-content-center"],["mat-button","",3,"click"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"h1",1),t._uU(2,"Agregar Usuario"),t.qZA(),t.TgZ(3,"div",2),t.TgZ(4,"p"),t._uU(5,"Registrar un nuevo auditor:"),t.qZA(),t.TgZ(6,"div",3),t.TgZ(7,"mat-form-field",4),t.TgZ(8,"mat-label"),t._uU(9,"Nombre Completo"),t.qZA(),t.TgZ(10,"input",5),t.NdJ("ngModelChange",function(r){return a.data.name=r}),t.qZA(),t.qZA(),t.TgZ(11,"mat-form-field",4),t.TgZ(12,"mat-label"),t._uU(13,"Correo:"),t.qZA(),t.TgZ(14,"input",6),t.NdJ("ngModelChange",function(r){return a.data.email=r}),t.qZA(),t.qZA(),t.TgZ(15,"mat-form-field",4),t.TgZ(16,"mat-label"),t._uU(17,"Pa\xeds"),t.qZA(),t.TgZ(18,"select",7),t.NdJ("ngModelChange",function(r){return a.data.country=r}),t.TgZ(19,"option",8),t._uU(20,"Colombia"),t.qZA(),t.TgZ(21,"option",9),t._uU(22,"Honduras"),t.qZA(),t.TgZ(23,"option",10),t._uU(24,"Costa Rica"),t.qZA(),t.TgZ(25,"option",11),t._uU(26,"El Salvador"),t.qZA(),t.TgZ(27,"option",12),t._uU(28,"Panam\xe1"),t.qZA(),t.TgZ(29,"option",13),t._uU(30,"Miami (USA)"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(31,"p",14),t._uU(32,"La contrase\xf1a por defecto es: 'auditoria2021'"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(33,"div",15),t.TgZ(34,"button",16),t.NdJ("click",function(){return a.onNoClick()}),t._uU(35,"Cancelar"),t.qZA(),t.TgZ(36,"button",17),t._uU(37,"Guardar"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(10),t.Q6J("ngModel",a.data.name),t.xp6(4),t.Q6J("ngModel",a.data.email),t.xp6(4),t.Q6J("ngModel",a.data.country),t.xp6(18),t.Q6J("mat-dialog-close",a.data))},directives:[c.uh,c.xY,p.KE,p.hX,v.Nt,d.Fj,d.JJ,d.On,d.EJ,d.Q7,d.YN,d.Kr,c.H8,T.lW,c.ZT],styles:[".inputs[_ngcontent-%COMP%]{width:100%}"]}),o})();var U=s(9525),A=s(9133),_=s(1769),q=s(6627);function M(o,n){1&o&&(t.TgZ(0,"th",20),t._uU(1," Correo "),t.qZA())}function D(o,n){if(1&o&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.email," ")}}function x(o,n){1&o&&(t.TgZ(0,"th",20),t._uU(1," Nombre "),t.qZA())}function N(o,n){if(1&o&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function O(o,n){1&o&&(t.TgZ(0,"th",20),t._uU(1," Estado "),t.qZA())}function S(o,n){if(1&o&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ","ADMIN_ROLE"==e.rol?"Administrador":"Auditor"," ")}}function Y(o,n){1&o&&(t.TgZ(0,"th",20),t._uU(1,"Acciones"),t.qZA())}function J(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td",22),t.TgZ(1,"button",23),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw().showUser(r.id)}),t.TgZ(2,"mat-icon"),t._uU(3,"remove_red_eye"),t.qZA(),t.qZA(),t.TgZ(4,"button",24),t.TgZ(5,"mat-icon"),t._uU(6,"power_settings_new"),t.qZA(),t.qZA(),t.TgZ(7,"button",25),t.TgZ(8,"mat-icon"),t._uU(9,"delete"),t.qZA(),t.qZA(),t.qZA()}}function P(o,n){1&o&&t._UZ(0,"tr",26)}function R(o,n){1&o&&t._UZ(0,"tr",27)}function L(o,n){if(1&o&&(t.TgZ(0,"tr",28),t.TgZ(1,"td",29),t._uU(2),t.qZA(),t.qZA()),2&o){t.oxw();const e=t.MAs(16);t.xp6(2),t.hij('No data matching the filter "',e.value,'"')}}let Q=(()=>{class o{constructor(e,a,i,r){this.userService=e,this.dialog=a,this.sweetAlert=i,this.router=r,this.data={email:"",name:""},this.userName="",this.displayedColumns=["email","name","state","actions"],this.usersData=[],this.dataSource=new l.by(this.usersData)}ngOnInit(){this.userName=localStorage.getItem("user-name")||"",this.loadData()}loadData(){this.userService.getAllUsers().subscribe(e=>{this.usersData=e.users,this.dataSource.data=this.usersData},e=>{console.log("Error obteniendo usuarios del backend"),console.log(e)})}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}addUser(){this.dialog.open(w,{width:"85%",data:this.data}).afterClosed().subscribe(a=>{if(a)if(this.verifyUserData(a)){const r=a;r.name=r.name.toUpperCase(),this.userService.createUser(r).subscribe(m=>{console.log(m)},m=>{console.log(m)})}else this.sweetAlert.presentError("Informaci\xf3n Inv\xe1lida!")})}verifyUserData(e){return!(!e.email||!e.name)}showUser(e){this.router.navigate(["/admin/users/"+e])}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(U.K),t.Y36(c.uw),t.Y36(A.T),t.Y36(u.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-list-users"]],viewQuery:function(e,a){if(1&e&&(t.Gf(b.NW,5),t.Gf(h.YE,5)),2&e){let i;t.iGM(i=t.CRH())&&(a.paginator=i.first),t.iGM(i=t.CRH())&&(a.sort=i.first)}},decls:34,vars:3,consts:[[1,"container","mt-3","mb-3"],[1,"row","ml-1","md-6","justify-content-center"],[1,"row"],[1,"col-md-4","col-xs-4"],["mat-raised-button","","color","primary",1,"boton","mt-3",3,"click"],["appearance","standard"],["matInput","","placeholder","Buscar un usuario en la tabla",3,"keyup"],["input",""],[1,"mat-elevation-z8",2,"width","100%"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","email"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","state"],["matColumnDef","actions"],["mat-cell","","class","d-flex flex-row bd-highlight",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",1,"d-flex","flex-row","bd-highlight"],["mat-mini-fab","","color","primary",1,"bd-highlight","fab-icono",3,"click"],["mat-mini-fab","",1,"bd-highlight","fab-icono"],["mat-mini-fab","","color","warn",1,"bd-highlight"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h1"),t._uU(3,"Listado de Usuarios Registrados"),t.qZA(),t.qZA(),t._UZ(4,"mat-divider"),t.TgZ(5,"div",2),t.TgZ(6,"div",3),t.TgZ(7,"button",4),t.NdJ("click",function(){return a.addUser()}),t._uU(8," Agregar Usuario "),t.TgZ(9,"mat-icon"),t._uU(10,"add"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",2),t.TgZ(12,"mat-form-field",5),t.TgZ(13,"mat-label"),t._uU(14,"Buscar..."),t.qZA(),t.TgZ(15,"input",6,7),t.NdJ("keyup",function(r){return a.applyFilter(r)}),t.qZA(),t.qZA(),t.TgZ(17,"div",8),t.TgZ(18,"table",9),t.ynx(19,10),t.YNc(20,M,2,0,"th",11),t.YNc(21,D,2,1,"td",12),t.BQk(),t.ynx(22,13),t.YNc(23,x,2,0,"th",11),t.YNc(24,N,2,1,"td",12),t.BQk(),t.ynx(25,14),t.YNc(26,O,2,0,"th",11),t.YNc(27,S,2,1,"td",12),t.BQk(),t.ynx(28,15),t.YNc(29,Y,2,0,"th",11),t.YNc(30,J,10,0,"td",16),t.BQk(),t.YNc(31,P,1,0,"tr",17),t.YNc(32,R,1,0,"tr",18),t.YNc(33,L,3,1,"tr",19),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(18),t.Q6J("dataSource",a.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns))},directives:[_.d,T.lW,q.Hw,p.KE,p.hX,v.Nt,l.BZ,h.YE,l.w1,l.fO,l.Dz,l.as,l.nj,l.Ee,l.ge,h.nU,l.ev,l.XQ,l.Gk],styles:["table[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{width:25%}.full-width-table[_ngcontent-%COMP%]{width:100%}.fa[_ngcontent-%COMP%]{font-size:large;transition:.2s ease;cursor:pointer;-moz-transition:1.5s ease;-webkit-transition:.5s ease;-o-transition:1.5s ease}.fa[_ngcontent-%COMP%]:hover{transform:scale(2);-moz-transform:scale(2);-webkit-transform:scale(2);-o-transform:scale(2);-ms-transform:scale(2)}.mat-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%}.mw-80[_ngcontent-%COMP%]{max-width:80%}.bold-text[_ngcontent-%COMP%]{font-weight:bold}.filtro[_ngcontent-%COMP%]{width:100%}.boton[_ngcontent-%COMP%]{width:100%}.fab-icono[_ngcontent-%COMP%]{margin-right:10px}"]}),o})();var I=s(4109),f=s(171),y=s(7746),g=s(9027);let G=(()=>{class o{constructor(){this.barChartOptions={responsive:!0,scales:{x:{},y:{min:0}}},this.barChartType="bar",this.barChartData={labels:["10 Dic","11 Dic","12 Dic","13 Dic","14 Dic","15 Dic","16 Dic","17 Dic"],datasets:[{data:[7,8,7.5,7,6,5.5,4,6,5,4,3],label:"Horas Trabajadas"}]}}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-bar-graph"]],viewQuery:function(e,a){if(1&e&&t.Gf(g.jh,5),2&e){let i;t.iGM(i=t.CRH())&&(a.chart=i.first)}},decls:2,vars:3,consts:[[2,"display","block"],["baseChart","",3,"data","options","type"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"canvas",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("data",a.barChartData)("options",a.barChartOptions)("type",a.barChartType))},directives:[g.jh],styles:[""]}),o})(),j=(()=>{class o{constructor(){this.pieChartOptions={responsive:!0},this.pieChartData={labels:["Pausas Activas","Auditor\xeda Daviplata","Daily"],datasets:[{data:[2,15,20]}]},this.pieChartType="pie"}ngOnInit(){}chartClicked({event:e,active:a}){console.log(e,a)}chartHovered({event:e,active:a}){console.log(e,a)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-pie-graph"]],viewQuery:function(e,a){if(1&e&&t.Gf(g.jh,5),2&e){let i;t.iGM(i=t.CRH())&&(a.chart=i.first)}},decls:2,vars:3,consts:[[1,"chart"],["baseChart","",3,"data","type","options"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"canvas",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("data",a.pieChartData)("type",a.pieChartType)("options",a.pieChartOptions))},directives:[g.jh],styles:[""]}),o})();function B(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"mat-list-option",7),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw().assignActivity(r)}),t._uU(1),t.qZA()}if(2&o){const e=n.$implicit,a=n.index,i=t.oxw();t.Q6J("selected",i.verifyUser(a))("disabled",e.is_general),t.xp6(1),t.hij(" ",e.name," ")}}const F=[{path:"",component:Q},{path:":id",component:(()=>{class o{constructor(e,a,i,r,m){this.userService=e,this.activityService=a,this.activatedRoute=i,this.sweetAlert=r,this.router=m,this.user={id:"",created_at:new Date,email:"",name:"",rol:"",updated_at:new Date},this.activities=[]}ngOnInit(){this.loadData();const e=this.activatedRoute.snapshot.paramMap.get("id");e?this.getUserById(e):(this.sweetAlert.presentError("Error iniciando el licor seleccionado (NO ID)"),this.router.navigate(["/admin/users"]))}getUserById(e){this.userService.getUserById(e).subscribe(a=>{this.user=a.user,console.log(a)},a=>{console.log(a)})}verifyUser(e){return!(!this.activities[e]||-1===(this.activities[e].users||[]).findIndex(r=>r.user._id===this.user.id))}loadData(){this.activityService.getActivities(!0).subscribe(e=>{this.activities=e.activities,console.log(e)},e=>{console.log(e)})}assignActivity(e){this.activityService.assignActivity({activity_id:e.id||"",user_id:this.user.id}).subscribe(i=>{console.log(i)},i=>{console.log(i)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(U.K),t.Y36(I.M),t.Y36(u.gz),t.Y36(A.T),t.Y36(u.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-show-user"]],decls:20,vars:2,consts:[[1,"container","mt-3","mb-3"],[1,"row","ml-1","md-6","justify-content-center"],[1,"row","ml-1","mt-3","md-6","justify-content-center"],[1,"row","mt-3"],[1,"col-4","col-md-4"],[1,"w-100"],[3,"selected","disabled","click",4,"ngFor","ngForOf"],[3,"selected","disabled","click"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h1"),t._uU(3),t.qZA(),t.qZA(),t._UZ(4,"mat-divider"),t.TgZ(5,"div",2),t.TgZ(6,"h3"),t._uU(7,"Detalle del time report:"),t.qZA(),t.qZA(),t.TgZ(8,"div",3),t.TgZ(9,"div",4),t.TgZ(10,"mat-expansion-panel"),t.TgZ(11,"mat-expansion-panel-header"),t.TgZ(12,"mat-panel-title"),t._uU(13," Asignar Actividades "),t.qZA(),t.qZA(),t.TgZ(14,"mat-selection-list",5),t.YNc(15,B,2,3,"mat-list-option",6),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"div",4),t._UZ(17,"app-bar-graph"),t.qZA(),t.TgZ(18,"div",4),t._UZ(19,"app-pie-graph"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.Oqu(a.user.name),t.xp6(12),t.Q6J("ngForOf",a.activities))},directives:[_.d,f.ib,f.yz,f.yK,y.Ub,C.sg,G,j,y.vS],styles:[".w-100[_ngcontent-%COMP%]{width:60%}"]}),o})()}];let E=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[u.Bz.forChild(F)],u.Bz]}),o})();var H=s(37);let k=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[C.ez,E,H.m]]}),o})()}}]);